---
title: Credentials
description: Credential management, password rotation, and security best practices for LXC container web services.
---

## Overview

LXC templates implement a secure credential management system with randomly generated passwords for all web services. This ensures each container deployment has unique credentials with no hardcoded defaults.

## Credential System

### Security Features

- **Random Generation**: 16-character alphanumeric passwords generated on first boot
- **Secure Storage**: Credentials stored in `/etc/pve-home-lab/credentials` (mode 600, root-only)
- **Unique Per Container**: Each container has different passwords
- **No Defaults**: No hardcoded passwords like "admin" or "coder"
- **Easy Retrieval**: Simple commands to view credentials from host or container

### What's Protected

All web services use password authentication:

| Service        | Port | Credentials                                     |
| -------------- | ---- | ----------------------------------------------- |
| VS Code Server | 8080 | `CODE_SERVER_PASSWORD` (16 chars)               |
| FileBrowser    | 8081 | `FILEBROWSER_USERNAME` + `FILEBROWSER_PASSWORD` |
| OpenCode       | 8082 | `OPENCODE_PASSWORD` (16 chars)                  |

## Viewing Credentials

### From ProxmoxVE Host

```bash
# View all credentials
pct exec <container-id> -- cat /etc/pve-home-lab/credentials

# Watch welcome banner (includes credentials)
pct exec <container-id> -- journalctl -u config-manager -f --no-pager -o cat
```

### Inside Container

```bash
# View credentials (requires root/sudo)
sudo cat /etc/pve-home-lab/credentials

# Check welcome message
cat /etc/motd
```

### Example Output

```bash
# Generated credentials for Web3 Dev Container
CODE_SERVER_PASSWORD=Abc123Xyz789Def4
FILEBROWSER_USERNAME=admin
FILEBROWSER_PASSWORD=Xyz456Abc123Ghi7
OPENCODE_PASSWORD=Def789Jkl012Mno3
```

## Password Management

### Recommended Workflow

1. **Deploy container** and wait for config-manager to complete
2. **Retrieve credentials** immediately after first boot
3. **Store in password manager** (1Password, Bitwarden, KeePass)
4. **Access web services** using stored passwords
5. **(Optional) Rotate passwords** for additional security

### Storing Credentials Securely

**DO:**

- ✅ Use a password manager
- ✅ Store container ID with credentials
- ✅ Note the container IP address
- ✅ Keep credentials file backed up
- ✅ Rotate passwords periodically

**DON'T:**

- ❌ Commit credentials to git
- ❌ Share over unencrypted channels
- ❌ Use same password across containers
- ❌ Store in browser password managers (for dev containers)

## Changing Passwords

### VS Code Server (code-server)

**Method 1: Plaintext Password**

```bash
# Inside container
sudo vim /etc/systemd/system/code-server@.service

# Update line:
# Environment=PASSWORD=your-new-password

# Reload and restart
sudo systemctl daemon-reload
sudo systemctl restart code-server@coder
```

**Method 2: Hashed Password (More Secure)**

```bash
# Generate hash (requires Node.js/npm)
echo -n "your-new-password" | npx argon2-cli -e

# Edit service file
sudo vim /etc/systemd/system/code-server@.service

# Update:
# Environment=PASSWORD=your-hash-here
# Environment=HASHED_PASSWORD=true

# Reload and restart
sudo systemctl daemon-reload
sudo systemctl restart code-server@coder
```

### FileBrowser

**Via CLI:**

```bash
# Update password
sudo filebrowser users update admin --password "new-password"

# Restart service
sudo systemctl restart filebrowser
```

**Via Web Interface:**

1. Login to FileBrowser: `http://<container-ip>:8081`
2. Go to **Settings** → **User Management**
3. Click on `admin` user
4. Enter new password
5. Save changes

### OpenCode

```bash
# Edit service file
sudo vim /etc/systemd/system/opencode@.service

# Update ExecStart line:
# ExecStart=/home/%i/.opencode/bin/opencode web --port 8082 --hostname 0.0.0.0 --password "new-password"

# Reload and restart
sudo systemctl daemon-reload
sudo systemctl restart opencode@coder
```

### Update Credentials File

After changing passwords, optionally update the reference file:

```bash
sudo vim /etc/pve-home-lab/credentials
```

**Note:** The credentials file is for reference only. Each service stores passwords independently.

## Security Best Practices

### Network Security

**ProxmoxVE Firewall:**

Restrict web service access to specific networks:

```bash
# Enable firewall for container
pct set <container-id> -net0 name=eth0,bridge=vmbr0,firewall=1,ip=dhcp
```

Then add firewall rules in ProxmoxVE web UI:

| Direction | Action | Protocol | Source         | Dest Port | Comment         |
| --------- | ------ | -------- | -------------- | --------- | --------------- |
| IN        | ACCEPT | TCP      | 192.168.1.0/24 | 8080-8082 | Allow from LAN  |
| IN        | ACCEPT | TCP      | 10.0.0.5       | 8080-8082 | Allow from VPN  |
| IN        | DROP   | TCP      | any            | 8080-8082 | Block all other |

**HTTPS with Reverse Proxy:**

For production or external access:

```nginx
# nginx example
server {
    listen 443 ssl http2;
    server_name code.example.com;

    ssl_certificate /etc/letsencrypt/live/code.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/code.example.com/privkey.pem;

    location / {
        proxy_pass http://<container-ip>:8080;
        proxy_set_header Host $host;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection upgrade;
    }
}
```

### Container Security

**Unprivileged Containers:**

Web3-dev template uses unprivileged containers by default:

```bash
# Verify container mode
pct config <container-id> | grep unprivileged
# Output: unprivileged: 1
```

**Restricted Sudo Access:**

The `coder` user has limited passwordless sudo:

```bash
# Allowed without password:
sudo systemctl status <service>
sudo docker ps
sudo git pull

# Requires password:
sudo apt install <package>
sudo passwd
```

### Password Rotation

**When to Rotate:**

- Every 90 days (recommended)
- After team member leaves
- If credentials may have been exposed
- Before production deployment

**Rotation Checklist:**

1. ✅ Take container snapshot
2. ✅ Change passwords for all services
3. ✅ Update credentials file
4. ✅ Test service access
5. ✅ Update password manager
6. ✅ Notify team members

## Troubleshooting

### Credentials File Not Found

**Symptom:** `/etc/pve-home-lab/credentials` doesn't exist

**Cause:** Config-manager hasn't completed first boot

**Solution:**

```bash
# Check config-manager status
journalctl -u config-manager -f

# If failed, restart
sudo systemctl restart config-manager
```

### Password Not Working

**Possible Causes:**

1. **Service not started:**

   ```bash
   sudo systemctl status code-server@coder
   sudo systemctl start code-server@coder
   ```

2. **Wrong credential retrieved:**

   ```bash
   grep CODE_SERVER_PASSWORD /etc/pve-home-lab/credentials
   ```

3. **Password contains special characters:**
   - Passwords are alphanumeric only (A-Za-z0-9)
   - Copy-paste exactly as shown

4. **Service configuration mismatch:**
   ```bash
   sudo cat /etc/systemd/system/code-server@.service | grep PASSWORD
   ```

### Service Won't Start After Password Change

**Check service logs:**

```bash
sudo journalctl -u code-server@coder -n 50
```

**Common Issues:**

- Missing `systemctl daemon-reload` after editing service file
- Syntax error in service file (missing quotes, etc.)
- Invalid password format (special characters in unquoted string)

**Fix:**

```bash
# Reload systemd
sudo systemctl daemon-reload

# Restart service
sudo systemctl restart code-server@coder

# Verify
sudo systemctl status code-server@coder
```

### Lost Credentials

**Recovery Options:**

1. **Retrieve from container:**

   ```bash
   pct exec <container-id> -- cat /etc/pve-home-lab/credentials
   ```

2. **Reset passwords** (follow password change procedures above)

3. **Regenerate (destructive):**
   ```bash
   # WARNING: This resets all services
   pct enter <container-id>
   sudo rm /etc/pve-home-lab/credentials
   sudo systemctl restart config-manager
   ```

## Advanced Topics

### Credential Backup

**Before major changes:**

```bash
# From ProxmoxVE host
pct exec <container-id> -- cat /etc/pve-home-lab/credentials > container-<container-id>-creds.txt

# Encrypt for storage
gpg -c container-<container-id>-creds.txt
```

### Container Cloning

⚠️ **WARNING:** Cloned containers will have identical credentials

**After cloning:**

```bash
# Enter new container
pct enter <new-container-id>

# Regenerate credentials
sudo rm /etc/pve-home-lab/credentials
sudo systemctl restart config-manager

# Or manually change all passwords
```

### Migration

**When migrating to new ProxmoxVE host:**

1. Backup credentials before migration
2. Take container snapshot
3. Migrate container using ProxmoxVE tools
4. Verify credentials file exists on new host
5. Test service access

## Related Documentation

- [Setup](/docs/container-templates/setup) - Container installation and quick start
- [Configuration](/docs/container-templates/configuration) - Configuration management reference
- [Troubleshooting](/docs/container-templates/troubleshooting) - Common issues and solutions

## Additional Resources

- Template README: `infra/lxc/templates/web3-dev/README.md`
- Detailed credential guide: `infra/lxc/templates/web3-dev/CREDENTIALS.md`
- Testing procedures: `infra/lxc/templates/web3-dev/TESTING.md`
